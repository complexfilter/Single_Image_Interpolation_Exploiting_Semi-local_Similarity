close all;clear;
%addpath('/Users/complexfilter/Dropbox/Dropbox/archive/TESTSET');
addpath('TESTSET');
N_im=23;
y=cell(N_im,1);
y{1}=double(imread('1_elk.bmp'));
y{2}=double(imread('2_birds.bmp'));
y{3}=double(imread('3_mornach.bmp'));
y{4}=double(imread('4_flower.bmp'));
y{5}=double(imread('5_woman.bmp'));
y{6}=double(imread('6_hats.bmp'));
y{7}=double(imread('7_leaves.bmp'));
y{8}=double(imread('8_man.tiff'));
y{9}=double(imread('9_motorbike.bmp'));
y{10}=double(imread('10_boat.bmp'));
y{11}=double(imread('11_cameraman.bmp'));
y{12}=double(rgb2gray(imread('12_dragonfly.jpg')));
y{13}=double(rgb2gray(imread('13_fence.tif')));
y{14}=double(rgb2gray(imread('14_fighter.jpg')));
y{15}=double(imread('15_lena.bmp'));
y{16}=double(imread('16_peppers.bmp'));
y{17}=double(rgb2gray(imread('17_sail.jpg')));y{17}=y{17}(5:end,:);
y{18}=double(imread('18_plane.bmp'));
y{19}=double(rgb2gray(imread('19_vase.jpg')));
y{20}=double(imread('20_house.tif'));
y{21}=double(imread('21_parrot.png'));
y{22}=double(imread('22_texture.png'));
y{23}=double(imread('23_foreman.tif'));


n=[8;6];
W=[20;20;30;30];
K=12;
lambda=[8*n(1)^2;8*n(2)^2;8*n(2)^2;10*n(2)^2];
cw=500;
sigma=0.85;
iter1=2;
iter2=2;
iter3=6;

psnr_store=zeros(N_im,1);
ssim_store=zeros(N_im,1);

yHR1=cell(N_im,1);
yHR2=cell(N_im,1);
yHR3=cell(N_im,1);
yHR4=cell(N_im,1);

mid_step2=cell(N_im,1);
mid_step3=cell(N_im,1);
mid_step4=cell(N_im,1);

for i=1:23
tic;    
disp(['interpolating image',num2str(i)]);    
[yHR4{i},yHR3{i},yHR2{i},yHR1{i},mid_step2{i},mid_step3{i},mid_step4{i}]=...
icassp2019(y{i}(1:2:end,1:2:end),size(y{i}),n,W,K,lambda,sigma,cw,iter1,iter2,iter3);
psnr_store(i)=PSNR(yHR4{i},y{i});
ssim_store(i)=ssim_index(yHR4{i},y{i});
disp(psnr_store(i));
toc;
end

save ICASSP.mat 




